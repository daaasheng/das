<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>g6</title>
    <style>
    .container{
        width: 960px;
        height: 600px;
    }
    </style>

</head>

<body>
    <div id="mountNode" class="container">
    
    </div>
    <script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.g6-3.2.3/build/g6.js"></script>
    <script>
        const data = {
            // 点集
            nodes: [
                {
                id: 'node1', // String，该节点存在则必须，节点的唯一标识
                x: 100, // Number，可选，节点位置的 x 值
                y: 200, // Number，可选，节点位置的 y 值
                color: 'red',
                label: '成都',
                },
                {
                id: 'node2', // String，该节点存在则必须，节点的唯一标识
                x: 300, // Number，可选，节点位置的 x 值
                y: 200, // Number，可选，节点位置的 y 值
                color: '#40a9ff',
                label: '北京'
                },
            ],
            // 边集
            edges: [
                {
                source: 'node1', // String，必须，起始点 id
                target: 'node2', // String，必须，目标点 id
                },
            ],
        };

        G6.registerEdge('circle-running', {
            afterDraw(cfg, group) {
                // 获得当前边的第一个图形，这里是边本身的 path
                const shape = group.get('children')[0];
                // 边 path 的起点位置
                const startPoint = shape.getPoint(0);

                // 添加红色 circle 图形
                const circle = group.addShape('circle', {
                attrs: {
                    x: startPoint.x,
                    y: startPoint.y,
                    fill: 'black',
                    r: 3
                }
                });

                // 对红色圆点添加动画
                circle.animate({
                // 动画重复
                repeat: true,
                // 每一帧的操作，入参 ratio：这一帧的比例值（Number）。返回值：这一帧需要变化的参数集（Object）。
                onFrame(ratio) {
                    // 根据比例值，获得在边 path 上对应比例的位置。
                    const tmpPoint = shape.getPoint(ratio);
                    // 返回需要变化的参数集，这里返回了位置 x 和 y
                    return {
                    x: tmpPoint.x,
                    y: tmpPoint.y
                    };
                }
                }, 3000); // 一次动画的时间长度
            }
        }, 'line');  // 该自定义边继承内置三阶贝塞尔曲线 cubic

        const graph = new G6.Graph({
            container: 'mountNode', // String | HTMLElement，必须，在 Step 1 中创建的容器 id 或容器本身
            width: 800, // Number，必须，图的宽度
            height: 500, // Number，必须，图的高度
            renderer: 'svg',
            style: {
                fill: '#DEE9FF',
                stroke: '#5B8FF9'
                },
            defaultEdge: {
                shape: 'circle-running',
                style: {
                lineWidth: 2,
                stroke: '#bae7ff'
                }
            }
        });

        graph.data(data)
        graph.render()
    
    
    </script>
</body>
</html>
