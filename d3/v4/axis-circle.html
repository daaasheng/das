<!DOCTYPE html>
<html>
<head>
	<title>axis</title>
	<script type="text/javascript" src="./d3.v4.js"></script>
	<style type="text/css">
		.demo-div{
			width: 960px;
			height: 600px;
		}
	</style>
</head>
<body>

<!-- <div class="demo-div" id="demo1">
	
</div> -->
<svg width="960" height="600"></svg>
<script type="text/javascript">
	// var svg = d3.select('#demo1').append("svg").attr("width", 500).attr("height", 900),
	var times = [20111001, 20111002, 20111003, 20111004, 20111005, 20111006];
	var datum = {
		key: 'finish-rate',
		name: '完成率',
		value: 38.56,
		legend: [
			{
				key: '',
				name: '趋降',
				range: [0, 20],
				color: '#5F8EB8',
			},
			{
				key: '',
				name: '过冷',
				range: [20, 80],
				color: '#74CEC5',
			},
			{
				key: '',
				name: '稳定',
				range: [80, 100],
				color: '#D78266',
			},
		],
	};

	var svg = d3.select("svg"),
	    margin = {top: 20, right: 80, bottom: 30, left: 50},
	    width = svg.attr("width") - margin.left - margin.right,
	    height = svg.attr("height") - margin.top - margin.bottom,
			bgRadius = 300,
			axisRadius = bgRadius - 40,
			outerRadius = axisRadius,
			innerRadius = 0.6 * axisRadius,
			scaleRadian = d3.scaleLinear().range([-Math.PI, Math.PI]).domain([0, 100]),
			arc = d3.arc().outerRadius(outerRadius).innerRadius(innerRadius),
			arcLine= d3.arc().outerRadius(outerRadius).innerRadius(0),
			// pie = d3.pie().outerRadius(outerRadius),
			// scaleAxis = d3.scaleLinear().range([-bgRadius, bgRadius]).domain([0, 100]);
			// axisTop = d3.axisTop(scaleAxis).ticks(5).tickSize(0).tickPadding(6);
			scaleLine = d3.lineRadial()
			gaugeGroup = svg.append("g").attr("class", "gauge-group").attr("transform", `translate(${bgRadius},${bgRadius})`);
			// 圆心为圆点， 绘制背景
			gaugeGroup.append("circle").attr("r", bgRadius).attr("fill", "#515151");
			gaugeGroup.append("path").attr("class", "bottom-arc")
					.attr("fill", "#000")
					.attr("d", arc({
						startAngle : scaleRadian(15),
						endAngle : scaleRadian(85)
					}));
			var axisGroup = gaugeGroup.append("g").attr("class", "axis-c");

			// 迭代
			// var tickGroup = axisGroup.append("g").attr("class", "tick")
			// .attr("opacity", "1");
			// tickGroup.append("line");
			// tickGroup.append("text");

			// function toAbsoluteWAngle(per) {
			// 	return scaleRadian(per) + 0.5 * Math.PI;
			// };
			var toDot = (per) => {
				var x = Math.cos(scaleRadian(per) - 0.5 * Math.PI) * axisRadius;
				var y = Math.sin(scaleRadian(per) - 0.5 * Math.PI) * axisRadius;
				return `${x},${y}`;
			}
			console.log(toDot(50));
			axisGroup.append("path").attr("class", "domain")
					.attr("fill", "none")
					.attr("stroke-width", "2px")
					.attr("stroke", '#fff')
					.attr("d", `M ${toDot(15)} A ${axisRadius},${axisRadius} 0 1,1 ${toDot(85)}`);
					// .attr("d", "M 0 0 L 300 200");
	//     g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	// var parseTime = d3.timeParse("%d-%b-%y");
	// var x = d3.scaleLinear().range([height, 0]).domain([0, 100]);
	// var axisLeft = d3.axisLeft(x).ticks(5).tickSize(0).tickPadding(6);
	// var y = d3.scaleBand().rangeRound([0, width]).padding(.1).domain(times.map(function (d) {
  //           return d;
  //       }));
	// var axisBottom = d3.axisBottom(y).ticks(times.length).tickSize(0).tickPadding(6);	
	// var z = d3.scaleOrdinal(d3.schemeCategory10);

	// // x.domain(times);

	// g.append("g")
  //     .attr("class", "axis x-axis")
  //     .attr("transform", "translate(0," + height + ")")
  //     .call(axisBottom);

  //  	g.append("g")
  //     .attr("class", "axis y-axis")
  //     .call(axisLeft);


    
</script>
</body>
</html>